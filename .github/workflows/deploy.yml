name: Deploy Application

on:
  push:
    branches: [ main, master ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      # 部署前端到Vercel
      - name: Deploy Frontend to Vercel
        uses: amondnet/vercel-action@v20
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          github-token: ${{ secrets.GITHUB_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          working-directory: ./frontend
          vercel-args: '--prod'
          
      # 注意：Render会自动监听GitHub仓库更新并部署，无需额外配置
      # 但我们可以添加一个步骤来通知用户部署状态
      - name: Notify Deployment Status
        run: |
          echo "Frontend deployment to Vercel initiated!"
          echo "Backend deployment to Render will be handled automatically."
          echo "Please check your Vercel and Render dashboards for deployment status."